# Random Number Generation and General Applications Related to Control Statements

Random number generation is one of the important topics in mathematics. Random numbers, or more accurately, numbers that give the impression of randomness (**pseudo-random numbers**), are used in many fields such as statistics, economics, mathematics, and software.

Random numbers are generated by a **random number generator (RNG)**. An RNG is essentially a mathematical function. This function takes a starting value and generates a number. Then, it takes each number it has generated as a new input and generates a new number. The numbers generated by the generator are random.

## The `rand` Function

The standard `rand` function generates random numbers. The declaration of this function is as follows:
```c
int rand(void);
```
The C standards do not impose a condition on the algorithm or technique that the `rand` function will use for random number generation. This matter is left **implementation-dependent**, relying on the choice of the compiler writers. The declaration of the `rand` function is in `stdlib.h`, a standard header file. Therefore, this header file must be included in the source code with the `#include` preprocessor directive when the `rand` function is called.
```c
#include <stdlib.h>
```
Each time the `rand` function is called, it returns a random integer value in the range $[0, \text{RAND\_MAX}]$. $\text{RAND\_MAX}$ is a symbolic constant defined in the `stdlib.h` header file. The C standards require this symbolic constant to be at least 32767. Almost all compilers define the $\text{RAND\_MAX}$ symbolic constant as 32767, which is the maximum value of the 2-byte signed `int` type:
```c
#define RAND_MAX 32767
```
In the following code snippet, 10 random numbers between 0 and $\text{RAND\_MAX}$ are generated and printed to the screen. Compile and run the program:
```c
#include <stdio.h>
#include <stdlib.h>
int main()
{
    int k;
    for (k = 0; k < 10; ++k)
        printf("%d ", rand());
    return 0;
}
```
The same sequence of numbers is printed to the screen every time the program created with the source code above is run. For example, when the program above was compiled and run with the Borland Turbo C 2.0 compiler under DOS, the screen output was as follows:

    346 130 10982 1090 11656 7117 17595 6415 22948 31126

## The `srand` Function

Why is the same sequence of numbers always obtained every time the created program is run? The `rand` function uses an algorithm to generate random numbers. Although this algorithm varies from compiler to compiler, the main theme used in random number generation is the same. It starts with a starting value, which is called the **seed value**. Some operations are performed on this value to obtain a random number. The operation performed on the seed value is then repeated on the generated random number.

Since the same seed value will be used every time a program containing calls to the `rand` function is run, the same sequence of numbers is obtained.

Another standard function, **`srand`**, is used to change the seed value of the random number generator. The declaration of the `srand` function, which is located in the `stdlib.h` header file, is as follows:
```c
void srand (unsigned seed);
```
The value sent to the `srand` function is made the seed value of the random number generator by the function. When another seed value is sent as an argument to the `srand` function, the sequence of random numbers generated by the function changes.

The `rand` and `srand` functions are defined below:
```c
#define RAND_MAX 32767
unsigned long int next = 1;
int rand()
{
    next = next * 1103515245 + 12345;
    return (unsigned int)(next / 65536) % 32768;
}
void srand(unsigned int seed)
{
    next = seed;
}
```
If the `srand` function is not called, the initial seed value is 1.

Recompile and run the program above by adding the `srand` function call:
```c
#include <stdio.h>
#include <stdlib.h>
int main()
{
    int k;
    srand(100);
    for (k = 0; k < 10; ++k)
        printf("%d ", rand());
    return 0;
}
```
When this program was compiled and run with the Borland Turbo C 2.0 compiler under DOS, the screen output was as follows:

    1862 11548 3973 4846 9095 16503 6335 13684 21357 21505

However, the sequence of numbers above is still obtained every time the created program is run, right? Even if the pre-selected (default) seed value used by the `rand` function is not used, the seed value sent to the `srand` function is used every time now. Run the program a few times and see if the same sequence of numbers is always generated.

In some situations, it is undesirable for the same random number sequence to be generated every time the program is run. For example, if the same numbers are always generated when a game program is run, the game is always played in the same way. To obtain a different number sequence every time the program runs, the `srand` function must set the random number generator's seed value to a different value every time the program runs. For this purpose, the standard **`time`** function is often used.

`time` is a standard C function; its declaration is in the standard header file `time.h`. We will only cover the `time` function, whose parameter is a pointer, in detail later. For now, we will examine the `time` function enough to serve our purpose. When the `time` function is sent the value 0, it returns the number of seconds that have passed since a predetermined date (01.01.1970 in most systems) until the moment the function is called. The return value of the function is a `long` type value in most compilers. If the return value of the `time` function is sent as an argument to the `srand` function in the program where random numbers will be generated, the random number generator will be initialized with a different seed value every time the program runs, due to the passage of a certain amount of time. Thus, a different number sequence is generated every time the program is run:
```c
srand(time(0));
```
This call to the `srand` function is defined as a non-standard macro named `randomize` in most compilers:
```
    randomize();
```
This macro can also be used instead of the function call above. The topic of macros will be covered in detail later.

Let's modify the previously written example program above so that it generates a different number sequence every time it runs:
```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
int main()
{
    int k;
    srand(time(0));
    for (k = 0; k < 10; ++k)
        printf("%d ", rand());
    return 0;
}
```
Sometimes, it is desired to generate random numbers in a specific range in programs. The remainder operator can be used for this purpose. Examine the following expressions:

* `rand() % 2`: Produces only the value 0 or 1.
* `rand() % 6`: Produces a random value in the range 0 - 5.
* `rand() % 6 + 1`: Produces a random value in the range 1 - 6. (e.g., a die roll value)
* `rand() % 6 + 3`: Produces a random value in the range 3 - 8.

However, the low-order bits of the random numbers generated by the random number generators provided by compiler programs are often not considered random. In this case, the expressions above do not provide an equal distribution for all numbers that should be generated.

Some methods can be used to achieve a more uniform distribution:

Instead of the expression:
```c
rand() % N
```
the following expressions can be written:
```c
rand()/(RAND_MAX / N + 1)

// or

(int)((double)rand() / ((double)RAND_MAX + 1) * N)
```
Or a function can be defined as follows:
```c
#include <stdio.h>
#include <stdlib.h>
#define N 10
int mrand()
{
    unsigned int x = (RAND_MAX + 1u) / N;
    unsigned int y = x * N;
    unsigned int r;
    while ((r = rand()) >= y)
        ;
    return r / x;
}
```
Placing the `srand(time(0))` call inside a loop is a common mistake.
```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
int zar_at() // die_roll
{
    srand(time(0)); // ERROR: Should be outside the loop
    return rand() % 6 + 1 +
        rand() % 6 + 1;
}
int main()
{
    int k;
    for (k = 0; k < 10; ++k)
        printf("%d\n", zar_at());
    return 0;
}
```
The `zar_at` function written above returns the sum of the values of two dice when a pair of dice is rolled. The `srand(time(0))` call is made inside the `zar_at` function. The `for` loop created inside the `main` function calls the `zar_at` function 10 times. The `time` function produces the same return value every time the function is called. In this case, since the same argument is passed to the `srand` function every time, the calls to the `rand` function also produce the same two numbers every time. That is, the same value is printed to the screen 10 times. The `srand(time(0))` call should have been made **before** the `for` loop inside the `main` function, right?

In the `main` function below, 10 random words consisting of letters of the English alphabet, with lengths ranging between 3 and 8 letters, are printed to the screen:
```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#define TIMES 10
#define MIN_WORD_LEN 3
#define MAX_WORD_LEN 8

void write_word(void)
{
    int len = rand() % (MAX_WORD_LEN - MIN_WORD_LEN + 1) + MIN_WORD_LEN;
    while (len--)
        putchar('A' + rand() % 26);
}
int main()
{
    int k;
    srand(time(0));
    for (k = 0; k < TIMES; ++k) {
        write_word();
        putchar('\n');
    }
    return 0;
}
```
Below, the generated words are now ensured not to contain vowels:
```c
int isvowel(int c)
{
    return c == 'A' || c == 'E' || c == 'I' || c == 'O' || c == 'U';
}
void write_word(void)
{
    int len = rand() % (MAX_WORD_LEN - MIN_WORD_LEN + 1) + MIN_WORD_LEN;
    int ch;
    while (len--) {
        while (isvowel(ch = rand() % 26 + 'A'))
            ;
        putchar(ch);
    }
}
```
Below, a function named `print_random_date` is defined that prints a random date to the screen. Every time the function is called, it prints a random but valid date information between 01.01.MIN\_YEAR and 31.12.MAX\_YEAR to the screen:
```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#define MAX_YEAR 2010
#define MIN_YEAR 1900

int isleap(int y)
{
    return y % 4 == 0 && y % 100 != 0 || y % 400 == 0;
}

void print_random_date()
{
    int d, m, y;
    y = rand() % (MAX_YEAR - MIN_YEAR + 1) + MIN_YEAR;
    m = rand() % 12 + 1;
    switch (m) {
        case 4 : case 6 : case 9 : case 11:
            d = rand() % 30 + 1; break;
        case 2 : d = rand() % (isleap(y) ? 29 : 28) + 1; break;
        default: d = rand() % 31 + 1;
    }
    printf("%d/%d/%d\n", d, m, y);
}

int main()
{
    int k;
    srand(time(0));
    for (k = 0; k < 20; ++k)
        print_random_date();
    return 0;
}
```
Probability problems can be solved by implementing the event of probability in a computer program. If a good random number generator is used, the event of probability is simulated by a computer program, and the event is subjected to a high number of repetitions, utilizing the processing speed of the computer. Undoubtedly, the probability value for the event to be calculated depends on the number of repetitions performed and the quality of the random number generator.

The following code calculates the probability of getting heads in a coin toss event:
```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#define TIMES 30000
#define HEADS 1
int main()
{
    int heads_counter = 0;
    int k;
    srand(time(0));
    for (k = 0; k < TIMES; ++k)
        if (rand() % 2 == HEADS)
            heads_counter++;
    printf("probability of heads = %lf", (double) heads_counter / TIMES);
    return 0;
}
```
When the program above was run for different values of the $\text{TIMES}$ symbolic constant, the screen output was as follows:

| `#define TIMES` | Screen Output |
| :--- | :--- |
| 100 | probability of heads = 0.480000 |
| 500 | probability of heads = 0.496000 |
| 2500 | probability of heads = 0.506800 |
| 10000 | probability of heads = 0.503500 |
| 30000 | probability of heads = 0.502933 |
| 100000 | probability of heads = 0.501450 |
| 1000000 | probability of heads = 0.500198 |

Below is another probability study being conducted:

Craps is a dice game played with two dice, known almost all over the world. The rules of the game are as follows:

The player rolling the dice plays against the house. If the sum of the two rolled dice is 7 or 11, the player wins. If the sum of the two rolled dice is 2, 3, or 12, the player loses. (This is called craps!)

If the sum of the two dice is a value other than those above (i.e., 4, 5, 6, 8, 9, 10), the game continues as follows:

The player rolls the dice again until they find the same result. If the player rolls a 7 before finding the same result, the player loses. If the player manages to roll the same result again before rolling a 7, they win.

A few examples:

| Player's Rolls | Game Result |
| :--- | :--- |
| 11 | Player wins |
| 3 | Player loses |
| 9 8 6 3 12 5 8 4 2 4 9 | Player wins |
| 6 5 8 9 2 3 7 | Player loses |
| 7 | Player wins |
| 10 4 8 11 8 3 6 5 4 9 10 | Player wins |

The following program calculates the winning probability of the player playing this game:
```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#define NKEZ 1000000 // N\_TIMES

int zar_at() // die\_roll
{
    int zar1 = rand() % 6 + 1;
    int zar2 = rand() % 6 + 1;
    return zar1 + zar2;
}

/* returns 1 if player wins, 0 if player loses */
int oyun_devami(int zar_toplam) // continue\_game
{
    int yeni_zar; // new\_roll
    for (;;) {
        yeni_zar = zar_at();
        if (yeni_zar == zar_toplam)
            return 1;
        if (yeni_zar == 7)
            return 0;
    }
}

/* returns 1 if player wins, 0 if player loses */
int oyun() // game
{
    int zar_toplam; // roll\_sum
    zar_toplam = zar_at();
    switch (zar_toplam) {
        case 7 :
        case 11: return 1;
        case 2 :
        case 3 :
        case 12: return 0;
    }
    return oyun_devami(zar_toplam);
}

int main()
{
    int k;
    int kazanma_sayisi = 0; // win\_count
    srand(time(0));
    for (k = 0; k < NKEZ; ++k)
        kazanma_sayisi += oyun();
    printf("winning probability = %lf\n", (double)kazanma_sayisi / NKEZ);
    return 0;
}
```
## Random Real Number Generation

There is no standard C function that generates random real numbers. However, a random real number in the range $0 - 1$ can be generated using the following expression, utilizing the $\text{RAND\_MAX}$ symbolic constant:
```c
(double)rand() / RAND_MAX
```
Below, a function named `drand` that generates a random real number is defined. Examine the function and try to understand how it generates a random real number:
```c
#define PRECISION 2.82e14

double drand()
{
    double sum = 0;
    double denom = RAND_MAX + 1;
    double need;
    for (need = PRECISION; need > 1; need /= (RAND_MAX + 1.)) {
        sum += rand() / denom;
        denom *= RAND_MAX + 1.;
    }
    return sum;
}

int main()
{
    int k;
    for (k = 0; k < 10; ++k)
        printf("%lf\n", drand());
    return 0;
}
```
The number $\pi$ is attempted to be found below using the method known as the Monte Carlo method. In this method, a quarter circle with a radius equal to the side length of a unit square is considered to be inside the unit square. A randomly selected point inside the unit square is either inside or outside the quarter circle. The probability of a randomly selected point being inside the quarter circle is the ratio of the area of a circle with a radius of 1 unit to the area of the square with a side of 1 unit. This is equal to the value $\frac{\pi}{4}$. Therefore, if we take $n$ random points and find how many of these points are inside the circle, 4 times the ratio of this value to the number $n$ gives the number $\pi$:

```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#define NTIMES 10000000
int main()
{
    double x, y;
    int k;
    int inside_counter = 0;
    srand(time(0));
    for (k = 0; k < NTIMES; ++k) {
        x = (double)rand() / RAND_MAX;
        y = (double)rand() / RAND_MAX;
        if (x * x + y * y <= 1)
            inside_counter++;
    }
    printf("calculated pi value = %lf\n", 4. * inside_counter / NTIMES);
    return 0;
}
```